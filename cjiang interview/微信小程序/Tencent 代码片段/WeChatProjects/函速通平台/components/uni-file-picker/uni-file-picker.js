(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["components/uni-file-picker/uni-file-picker"],{"0fae":function(e,t,r){"use strict";(function(e,n){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=u(r("a34a")),s=r("6e4a"),a=r("3201");function u(e){return e&&e.__esModule?e:{default:e}}function l(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function o(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?l(Object(r),!0).forEach((function(t){c(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):l(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function c(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function f(e,t){var r="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=d(e))||t&&e&&"number"===typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,a=!0,u=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){u=!0,s=e},f:function(){try{a||null==r.return||r.return()}finally{if(u)throw s}}}}function h(e){return b(e)||m(e)||d(e)||p()}function p(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function d(e,t){if(e){if("string"===typeof e)return g(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?g(e,t):void 0}}function m(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function b(e){if(Array.isArray(e))return g(e)}function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function y(e,t,r,n,i,s,a){try{var u=e[s](a),l=u.value}catch(o){return void r(o)}u.done?t(l):Promise.resolve(l).then(n,i)}function v(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var s=e.apply(t,r);function a(e){y(s,n,i,a,u,"next",e)}function u(e){y(s,n,i,a,u,"throw",e)}a(void 0)}))}}var x=function(){r.e("components/uni-file-picker/upload-image").then(function(){return resolve(r("3f3d"))}.bind(null,r)).catch(r.oe)},k=function(){r.e("components/uni-file-picker/upload-file").then(function(){return resolve(r("3eb7"))}.bind(null,r)).catch(r.oe)},w={name:"uniFilePicker",components:{uploadImage:x,uploadFile:k},emits:["select","success","fail","progress","delete","update:modelValue","input"],props:{value:{type:[Array,Object],default:function(){return[]}},disabled:{type:Boolean,default:!1},disablePreview:{type:Boolean,default:!1},delIcon:{type:Boolean,default:!0},autoUpload:{type:Boolean,default:!0},limit:{type:[Number,String],default:9},mode:{type:String,default:"grid"},fileMediatype:{type:String,default:"image"},fileExtname:{type:[Array,String],default:function(){return[]}},title:{type:String,default:""},listStyles:{type:Object,default:function(){return{border:!0,dividline:!0,borderStyle:{}}}},imageStyles:{type:Object,default:function(){return{width:"auto",height:"auto"}}},readonly:{type:Boolean,default:!1},returnType:{type:String,default:"array"},sizeType:{type:Array,default:function(){return["original","compressed"]}},uploadUrl:{type:String,default:""},fileUrl:{type:String,default:""},compressSize:{type:[String,Number],default:1}},data:function(){return{files:[],localValue:[]}},watch:{value:{handler:function(e,t){this.setValue(e,t)},immediate:!0,deep:!0}},computed:{filesList:function(){var e=[];return this.files.forEach((function(t){e.push(t)})),e},showType:function(){return this.mode},limitLength:function(){return"object"===this.returnType?1:this.limit?this.limit>=9?9:this.limit:1}},created:function(){e.config&&e.config.provider||(this.noSpace=!0,e.chooseAndUploadFile=s.chooseAndUploadFile),this.form=this.getForm("uniForms"),this.formItem=this.getForm("uniFormsItem"),this.form&&this.formItem&&this.formItem.name&&(this.rename=this.formItem.name,this.form.inputChildrens.push(this))},methods:{clearFiles:function(e){var t=this;0===e||e?this.files.splice(e,1):(this.files=[],this.$nextTick((function(){t.setEmit()}))),this.$nextTick((function(){t.setEmit()}))},upload:function(){var e=[];this.files.forEach((function(t,r){"ready"!==t.status&&"error"!==t.status||e.push(Object.assign({},t))})),this.uploadFiles(e)},compressFile:function(){var e=this;return v(i.default.mark((function t(){var r,n,a,u;return i.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:r=h(e.files),n=f(r),t.prev=2,n.s();case 4:if((a=n.n()).done){t.next=14;break}if(u=a.value,"ready"!==u.status&&"error"!==u.status){t.next=12;break}if("image"!=u.fileType){t.next=11;break}return t.next=10,(0,s.compress)(u,u.fileType);case 10:u.path=t.sent;case 11:console.log("item.path",u.path);case 12:t.next=4;break;case 14:t.next=19;break;case 16:t.prev=16,t.t0=t["catch"](2),n.e(t.t0);case 19:return t.prev=19,n.f(),t.finish(19);case 22:e.files=r,e.upload();case 24:case"end":return t.stop()}}),t,null,[[2,16,19,22]])})))()},setValue:function(e,t){var r=this;return v(i.default.mark((function t(){var n,s,a,u;return i.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=function(){var e=v(i.default.mark((function e(t){var n,s;return i.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=/cloud:\/\/([\w.]+\/?)\S*/,s="",s=t.fileID?t.fileID:t.url,!n.test(s)){e.next=8;break}return t.fileID=s,e.next=7,r.getTempFileURL(s);case 7:t.url=e.sent;case 8:return t.path=t.url,e.abrupt("return",t);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),"object"!==r.returnType){t.next=10;break}if(!e){t.next=7;break}return t.next=5,n(e);case 5:t.next=8;break;case 7:e={};case 8:t.next=19;break;case 10:e||(e=[]),s=0;case 12:if(!(s<e.length)){t.next=19;break}return a=e[s],t.next=16,n(a);case 16:s++,t.next=12;break;case 19:r.localValue=e,r.form&&r.formItem&&!r.is_reset&&(r.is_reset=!1,r.formItem.setValue(r.localValue)),u=Object.keys(e).length>0?e:[],r.files=[].concat(u);case 23:case"end":return t.stop()}}),t)})))()},choose:function(){this.disabled||(this.files.length>=Number(this.limitLength)&&"grid"!==this.showType&&"array"===this.returnType?n.showToast({title:"您最多选择 ".concat(this.limitLength," 个文件"),icon:"none"}):this.chooseFiles())},chooseFiles:function(){var t=this,r=(0,a.get_extname)(this.fileExtname);e.chooseAndUploadFile({type:this.fileMediatype,compressed:!1,sizeType:this.sizeType,extension:r.length>0?r:void 0,count:this.limitLength-this.files.length,onChooseFile:this.chooseFileCallback},this.compressSize).then((function(e){t.setSuccessAndError(e.tempFiles,"choose")})).catch((function(e){console.log("选择失败",e)}))},chooseFileCallback:function(e){var t=this;return v(i.default.mark((function r(){var n,s,u,l,c,f,h,p;return i.default.wrap((function(r){while(1)switch(r.prev=r.next){case 0:n=(0,a.get_extname)(t.fileExtname),s=1===Number(t.limitLength)&&t.disablePreview&&!t.disabled||"object"===t.returnType,s&&(t.files=[]),u=(0,a.get_files_and_is_max)(e,n),l=u.filePaths,c=u.files,n&&n.length>0||(l=e.tempFilePaths,c=e.tempFiles),f=[],h=0;case 7:if(!(h<c.length)){r.next=21;break}if(!(t.limitLength-t.files.length<=0)){r.next=10;break}return r.abrupt("break",21);case 10:return c[h].uuid=Date.now(),r.next=13,(0,a.get_file_data)(c[h],t.fileMediatype);case 13:p=r.sent,p.progress=0,p.status="ready",t.files.push(o(o({},p),{},{file:c[h]})),f.push(o(o({},p),{},{file:c[h]}));case 18:h++,r.next=7;break;case 21:t.$emit("select",{tempFiles:f,tempFilePaths:l}),e.tempFiles=c;case 23:case"end":return r.stop()}}),r)})))()},uploadFiles:function(e){var t=this,r=[].concat(e);s.uploadCloudFiles.call(this,r,r.length,this.uploadUrl,this.fileUrl,(function(e){t.setUpLoadProgress(e,e.index,!0)})).then((function(e){t.setSuccessAndError(e)})).catch((function(e){console.log(e)}))},setSuccessAndError:function(e,t,r){var n=this;return v(i.default.mark((function r(){var s,a,u,l,o,c,f;return i.default.wrap((function(r){while(1)switch(r.prev=r.next){case 0:s=[],a=[],u=[],l=[],o=i.default.mark((function r(o){var c,f,h,p;return i.default.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(c=e[o],f=c.uuid?n.files.findIndex((function(e){return e.uuid===c.uuid})):c.index,-1!==f&&n.files){r.next=4;break}return r.abrupt("return","break");case 4:if(!c.errMsg||-1===c.errMsg.indexOf("request:fail")){r.next=12;break}n.$set(n.files[f],"url",c.path),n.$set(n.files[f],"status","error"),n.$set(n.files[f],"errMsg",c.errMsg),a.push(n.files[f]),l.push(n.files[f].url),r.next=27;break;case 12:if(n.$set(n.files[f],"errMsg",""),n.$set(n.files[f],"fileID",c.url),h=/cloud:\/\/([\w.]+\/?)\S*/,!h.test(c.url)){r.next=22;break}return r.next=18,n.getTempFileURL(c.url);case 18:p=r.sent,n.$set(n.files[f],"url",p),r.next=23;break;case 22:n.$set(n.files[f],"url",c.url);case 23:n.files[f].progress+=1,"choose"!=t&&(n.$set(n.files[f],"attachBatchId",c.attachBatchId),n.$set(n.files[f],"attachId",c.attachId),n.$set(n.files[f],"status","success")),s.push(n.files[f]),u.push(n.files[f].fileID);case 27:case"end":return r.stop()}}),r)})),c=0;case 6:if(!(c<e.length)){r.next=14;break}return r.delegateYield(o(c),"t0",8);case 8:if(f=r.t0,"break"!==f){r.next=11;break}return r.abrupt("break",14);case 11:c++,r.next=6;break;case 14:if(!(s.length>0)){r.next=23;break}if("choose"!=t){r.next=18;break}return n.compressFile(),r.abrupt("return");case 18:if("compress"!=t){r.next=21;break}return n.upload(),r.abrupt("return");case 21:n.setEmit(),n.$emit("success",{tempFiles:n.backObject(s),tempFilePaths:u});case 23:a.length>0&&n.$emit("fail",{tempFiles:n.backObject(a),tempFilePaths:l});case 24:case"end":return r.stop()}}),r)})))()},setUpLoadProgress:function(e,t,r){var n=e.progress,i=t;r||(i=this.files.findIndex((function(t){return t.uuid===e.tempFile.uuid}))),-1!==i&&this.files[i]&&(this.files[i].progress=n-1,this.$emit("progress",{index:i,progress:parseInt(n),tempFile:this.files[i]}))},setProgress:function(e,t,r){this.files.length;var n=Math.round(100*e.loaded/e.total),i=t;r||(i=this.files.findIndex((function(t){return t.uuid===e.tempFile.uuid}))),-1!==i&&this.files[i]&&(this.files[i].progress=n-1,this.$emit("progress",{index:i,progress:parseInt(n),tempFile:this.files[i]}))},delFile:function(e){var t=this;this.$emit("delete",{tempFile:this.files[e],tempFilePath:this.files[e].url}),this.files.splice(e,1),this.$nextTick((function(){t.setEmit()}))},getFileExt:function(e){var t=e.lastIndexOf("."),r=e.length;return{name:e.substring(0,t),ext:e.substring(t+1,r)}},setEmit:function(){var e=[];"object"===this.returnType?(e=this.backObject(this.files)[0],this.localValue=e||null):(e=this.backObject(this.files),this.localValue||(this.localValue=[]),this.localValue=h(e)),this.$emit("input",this.localValue)},backObject:function(e){var t=[];return e.forEach((function(e){t.push({extname:e.extname,fileType:e.fileType,image:e.image,name:e.name,path:e.path,size:e.size,fileID:e.fileID,url:e.url,errMsg:e.errMsg,status:e.status,attachBatchId:e.attachBatchId||"",attachId:e.attachId||""})})),t},getTempFileURL:function(t){return v(i.default.mark((function r(){var n;return i.default.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return t={fileList:[].concat(t)},r.next=3,e.getTempFileURL(t);case 3:return n=r.sent,r.abrupt("return",n.fileList[0].tempFileURL||"");case 5:case"end":return r.stop()}}),r)})))()},getForm:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"uniForms",t=this.$parent,r=t.$options.name;while(r!==e){if(t=t.$parent,!t)return!1;r=t.$options.name}return t}}};t.default=w}).call(this,r("a9ff")["default"],r("543d")["default"])},"43e3":function(e,t,r){"use strict";r.r(t);var n=r("add6"),i=r("8775");for(var s in i)["default"].indexOf(s)<0&&function(e){r.d(t,e,(function(){return i[e]}))}(s);r("a9a0");var a,u=r("f0c5"),l=Object(u["a"])(i["default"],n["b"],n["c"],!1,null,"3af81697",null,!1,n["a"],a);t["default"]=l.exports},8775:function(e,t,r){"use strict";r.r(t);var n=r("0fae"),i=r.n(n);for(var s in n)["default"].indexOf(s)<0&&function(e){r.d(t,e,(function(){return n[e]}))}(s);t["default"]=i.a},a9a0:function(e,t,r){"use strict";var n=r("d5ce"),i=r.n(n);i.a},add6:function(e,t,r){"use strict";var n;r.d(t,"b",(function(){return i})),r.d(t,"c",(function(){return s})),r.d(t,"a",(function(){return n}));var i=function(){var e=this,t=e.$createElement;e._self._c},s=[]},d5ce:function(e,t,r){}}]);
;(global["webpackJsonp"] = global["webpackJsonp"] || []).push([
    'components/uni-file-picker/uni-file-picker-create-component',
    {
        'components/uni-file-picker/uni-file-picker-create-component':(function(module, exports, __webpack_require__){
            __webpack_require__('543d')['createComponent'](__webpack_require__("43e3"))
        })
    },
    [['components/uni-file-picker/uni-file-picker-create-component']]
]);
