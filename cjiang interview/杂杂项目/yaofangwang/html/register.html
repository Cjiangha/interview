<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>

    <link rel="stylesheet" href="../lib/inconfig/font/iconfont.css">
    <link rel="stylesheet" href="../css/register.css">
</head>

<body>
    <div id="box">
        <div class="header">
            <div class="sitenav">
                <div class="content">
                    <ul class="left">
                        <!-- 登录注册 -->
                        <li><a href="../html/login.html" target="_self">请登录</a></li>
                        <li><a href="../html/register.html" target="_self">注册</a></li>
                        <!-- 我的药房网 -->
                        <li id="myyaofang">
                            <strong>
                                我的药房网
                                <i class="iconfont iconfont_up" style="width: 6px;height:6px;">&#xe60a;</i>
                            </strong>

                            <ul class="qingdan">
                                <li>我的清单</li>
                                <li>我的优惠券</li>
                                <li>我的留言</li>
                                <li>我的帖子</li>
                            </ul>
                        </li>
                        <!-- 需求清单 -->
                        <li>
                            <a>
                                <i class="iconfont ">&#xe623;</i>
                                需求清单
                            </a>
                        </li>
                        <!-- 手机版 -->
                        <li id="phoneli">
                            <strong>
                                <i class="iconfont"> &#xe638;</i>
                                手机版
                                <i class="iconfont">&#xe60a;</i>
                            </strong>
                            <!-- 下面的二维码 -->
                            <div class="iphonebanben">
                                <span>方式一</span>
                                <span>扫描访问Wap站</span>
                                <img src="../images/erweima.jpg" alt="">
                            </div>
                        </li>
                        <!-- 网站导航 -->
                        <li class="daohang">
                            <i></i>
                            <strong>网站导航</strong>
                            <i class="iconfont">&#xe60a;</i>
                            <!-- 网站导航下的dl标签 -->
                            <div class="hidedaohang siteNav ">
                                <!-- 热门专区
                                    重大疾病
                                    情趣商城 
                                    慢性疾病
                                    特产商城 常见疾病
                                    宁草堂 健康商城
                                    健康社区 体检商城  -->
                                <dl class="two">
                                    <dt>热门专区</dt>
                                    <dd>
                                        <a href="###" target="_blank" style="color:#e50007;">重大疾病</a>
                                        <a href="###" target="_blank" style="color:#e50007;">重大疾病</a>
                                        <a href="###" target="_blank" style="color:#e50007;">&nbsp;</a>
                                        <a href="###" target="_blank" style="color:#e50007;">重大疾病</a>
                                        <a href="###" target="_blank" style="color:#e50007;">重大疾病</a>
                                        <a href="###" target="_blank" style="color:#e50007;">&nbsp;</a> <a href="###"
                                            target="_blank" style="color:#e50007;">重大疾病</a>
                                        <a href="###" target="_blank" style="color:#e50007;">重大疾病</a>
                                        <a href="###" target="_blank" style="color:#e50007;">&nbsp;</a> <a href="###"
                                            target="_blank" style="color:#e50007;">重大疾病</a>
                                        <a href="###" target="_blank" style="color:#e50007;">重大疾病</a>
                                        <a href="###" target="_blank" style="color:#e50007;">&nbsp;</a> <a href="###"
                                            target="_blank" style="color:#e50007;">重大疾病</a>
                                        <a href="###" target="_blank" style="color:#e50007;">重大疾病</a>
                                        <a href="###" target="_blank" style="color:#e50007;">&nbsp;</a>
                                    </dd>
                                </dl>
                                <dl class="two">
                                    <dt>特色频道</dt>
                                    <dd>
                                        <a href="###" target="_blank" style="color:#e50007;">男科疾病</a>
                                        <a href="###" target="_blank" style="color:#e50007;">消化不良</a>
                                    </dd>
                                </dl>
                                <dl class="last">
                                    <dt>特色频道</dt>
                                    <dd> <a href="###" target="_blank" style="color:#e50007;">男科疾病</a>
                                        <a href="###" target="_blank" style="color:#e50007;">消化不良</a></dd>
                                </dl>
                            </div>
                        </li>
                    </ul>
                    <div class="tempWrap">
                        <ul class="rexian">
                            <li class="clone" style="height: 31px;">
                                <a href="javascript:;" style="color:#5b5b5b;cursor:default;">
                                    <i class="iconfont">&#xe630;</i>
                                    食品药品投诉举报热线：12331
                                </a>
                            </li>
                            <li> <a href="javascript:;" style="color:#5b5b5b;cursor:default;">
                                    <i class="iconfont">&#xe630;</i>
                                    食品药品投诉举报热线：12331
                                </a></li>
                            <li> <a href="javascript:;" style="color:#5b5b5b;cursor:default;">
                                    <i class="iconfont">&#xe630;</i>
                                    食品药品投诉举报热线：12331
                                </a></li>
                            <li> <a href="javascript:;" style="color:#5b5b5b;cursor:default;">
                                    <i class="iconfont">&#xe630;</i>
                                    食品药品投诉举报热线：12331
                                </a></li>
                            <li> <a href="javascript:;" style="color:#5b5b5b;cursor:default;">
                                    <i class="iconfont">&#xe630;</i>
                                    食品药品投诉举报热线：12331
                                </a></li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="site_head clearfix">
                <div class="content">
                    <div class="logo">
                        <a href="../index.html" style="display: block">
                            <img src="../images/logo.png" alt="">
                        </a>
                    </div>
                    <p>我已注册,
                        <a href="../html/login.html" target="_blank">立即登录</a>
                    </p>

                </div>

            </div>
        </div>

        <div class="head"></div>
        <div class="main">
            <div class="content">
                <div class="zhuce">
                    <b>新用户注册</b>
                </div>
                <div class="line"></div>
                <ul class="form">
                    <li>
                        <span>用户名</span>
                        <input type="text" value="" id="username" placeholder="建议使用常用的手机号作为用户名" maxlength="11">
                        <div class="error_msg usertishi" style="color: rgb(204, 204, 204);">必须为手机号码
                        </div>
                    </li>
                    <li>
                        <span>设置密码 </span>
                        <input type="password" value="" id="pwd" placeholder="6-20位字符,可使用字母、数字">
                        <div class="error_msg pwdtishi" style="color: rgb(204, 204, 204);">
                            密码范围在6~20位之间</div>
                    </li>
                    <li>
                        <span> 确认密码</span>
                        <input type="password" id="repwd" value="" placeholder="请再次输入密码">
                        <div class="error_msg repwdtishi" style="color: rgb(204, 204, 204);">密码范围在6~20位之间</div>
                    </li>
                    <!-- <li class="yanzheng">
                        <a>点击按钮进行验证</a>

                    </li>
                    <li class="yzm">
                        <span> 短信验证码 </span>
                        <input type="text">
                        <span>获取手机验证码</span>
                        <div class="yanzhengmatishi error_msg" style="color: rgb(204, 204, 204);" id="yanzhengmatishi">
                            请输入正确的短信验证码！</div>
                    </li> -->
                    <li class="xieyi">
                        <input type="checkbox" id="cbox">
                        <span>《仁和药房网用户注册协议》</span>
                    </li>

                    <input type="button" value="立即注册" class="sumbit" id="btn" style="cursor: pointer;">
                </ul>
            </div>
        </div>

        <div class="foot">
            <div class="footer">
                <div class="footer_bottom">
                    <div class="content">
                        <p>
                            Copyright &copy; 2005-2019 仁和药房网（北京）医药科技有限公司版权所有，并保留所有权利。互联网药品交易服务证：京C20160005号
                        </p>
                        <p>
                            <img src="../images/copy_ico.jpg" alt="">
                            <span>京公网安备 11010602100232号 电信与信息服务业务经营许可证：京ICP证041574号 京ICP备10054530号-1</span>
                        </p>
                        <p>
                            增值电信业务经营许可证：京B2-20180434
                            <a href="https://m.yaofang.cn/" rel="nofollow" style="color: rgb(96,228,223)">移动版</a>
                        </p>

                        <div style="height:50px;"></div>
                    </div>
                </div>
            </div>
        </div>

    </div>
</body>
<script src="../js/jquery-1.10.1.min.js"></script>
<script src="../js/j-common.js"></script>
<script src="../js/reg.js"></script>
<script>

    (function () {
        function init() {
            let ckie = getCookie('username');
            if (ckie) {//登录中，有值即为真
                let welcomestr = `<a href="###">${ckie}，欢迎来到药房网</a>！`
                let quit = `<a class="qt"  href="###">退出</a>`;
                $('#welcome').html(welcomestr);
                $('#quit').html(quit);

            } else {//登出
                let dl1 = ` <a target="_self" href="html/login.html">请登录</a>
               `;
                let dl2 = ` <a target="_self" href="html/register.html">注册</a>`;
                $('#welcome').html(dl1);
                $('#quit').html(dl2);
            }
        }
        init();
        //当点击退出按钮就把cookie清除
        $('.left').delegate('.qt', 'click', function () {
            removeCookie('username');
            // 跳到首页
            location.href = 'index.html';
            // location
            init();
        })
    })();
    (function () {
        let myyaofang = document.getElementById('myyaofang');
        let qingdan = document.getElementsByClassName('qingdan')[0];

        myyaofang.onmouseover = (ev) => {
            ev.stopPropagation();//阻止冒泡
            qingdan.style.display = 'block';
        }
        myyaofang.onmouseout = ev => {
            qingdan.style.display = 'none';
        }

        $('#phoneli').mouseenter(function () {
            $(".iphonebanben").show()
        });
        $('#phoneli').mouseleave(function () {
            $(".iphonebanben").hide();

        });

        $('.daohang').mouseenter(function () {
            $(".hidedaohang ").show()
        });
        $('.daohang').mouseleave(function () {
            $(".hidedaohang ").hide()
        });


        var i = 0;//准备一个变量作为倍数
        $('.rexian li').innerHeight();
        // 把第一个元素插入到第五个元素后面
        $('.rexian li').eq(0).clone(true).appendTo('.rexian');

        //找到里面的节点，让ul一直向上移动1个innerheight
        function next() {
            let diejia = $('.rexian li').innerHeight();
            if (i > $('.rexian li').size() - 1) {
                i = 1;
                $('.rexian').css('top', 0);
                // $('.rexian').animate({ top: 0 });
            }
            $('.rexian').animate({ top: (-(diejia - 1) * i) + 'px' });
            i++;
        }
        setInterval(next, 2000);
    })();


    // 注册和ajax的功能
    (function () {
        // 
        let input1 = document.querySelector('#username');//用户名
        let input2 = document.querySelector('#pwd');//密码
        let input3 = document.querySelector('#repwd');
        let input4 = document.querySelector('#cbox');
        let tishi1 = document.querySelector('.usertishi');
        let tishi2 = document.querySelector('.pwdtishi');
        let tishi3 = document.querySelector('.repwdtishi');
        let isok = true;

        checkInput2(input1, 'tel', tishi1, {
            success: '手机输入正确',
            failure: '手机输入错误',
            null: '手机不能为空'
        });
        console.log(input1.istrue);
        checkInput2(input2, 'password', tishi2, {
            success: '密码输入正确',
            failure: '密码范围在6~20位之间',
            null: '密码不能为空'
        });


        // })



        // 确认密码和输入的密码不符合，失去较短事件
        input3.onblur = function () {
            if (input3.value == '') {
                tishi3.style = 'color:red;';
                tishi3.innerHTML = '输入为空';
            }
            else if (input3.value == input2.value) {
                tishi3.style = 'color:#58bc58'
                tishi3.innerHTML = '输入正确';
            } else {
                tishi3.style = 'color:red;';
                tishi3.innerHTML = '您输入的密码不一致';
            }
        }

        /* data：用户名和密码传过去进行判断是否能注册  reg,传回来的值，
           success: 1、用户名存在：  'resultCode'=>500,
                                    'message'=>'注册失败！'
                                           
                    2、用户名不存在， 'resultCode'=>200,
                                    'message'=>'注册成功！'
        */
        let btn = document.querySelector('#btn');
        let yanzhengmatishi = document.querySelector('#yanzhengmatishi');



        btn.onclick = function () {//按钮点击

        }

        btn.onclick = function () {
            if (checkReg['tel'](input1.value) && checkReg['password'](input2.value) && $("#cbox").prop("checked") && input2.value == input3.value && input1 != '' && input2 != '') {
                // 两个正则判断，复选框勾选判断，
                ajax({
                    type: 'post',
                    url: '../api/reg.php',
                    data: {
                        username: input1.value,
                        psw: input2.value,
                    },
                    success: str => {
                        let arr = JSON.parse(str);
                        //取节点
                        console.log(arr);
                        if (arr.resultCode == 200) { //注册成功
                            yanzhengmatishi.innerHTML = arr.message;
                            yanzhengmatishi.style = 'color:#585858';
                            location.href = 'login.html';
                        }
                        else if (arr.resultCode == 500) {
                            yanzhengmatishi.innerHTML = arr.message;
                            yanzhengmatishi.style = 'color:red';
                        }
                    }
                })
                //正则判断准确
                // alert('sucessful!');
                // console.log();
            }
            else {
                alert('抱歉  注册的信息有误 请重新填写！！');
            }

        }

    })();

</script>

</html>