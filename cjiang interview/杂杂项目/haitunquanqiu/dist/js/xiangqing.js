"use strict";!function(){var i=861;$(window).scroll(function(){$(window).scrollTop()>=i?($(".m-aside .mt").addClass("dingwei"),$("#detail .tab-main").addClass("dingwei")):($(".m-aside .mt").removeClass("dingwei"),$("#detail .tab-main").removeClass("dingwei"))}),$(".detail .ETab div.large li").eq(0).click(function(){$(this).addClass("current").siblings().removeClass("current"),$("#detail .tab-con").css("display","block"),$(".comment").css("display","none"),$(window).scrollTop()>=i&&$(window).scrollTop(860)}),$(".detail .ETab div.large li").eq(1).click(function(){$(this).addClass("current").siblings().removeClass("current"),$("#detail .tab-con").css("display","none"),$(".comment").css("display","block"),$(window).scrollTop()>=i&&$(window).scrollTop(860)});var a=decodeURI(location.search.slice(1));setCookie("baby",a),$.ajax({type:"get",url:"../api/xiangqing.php",data:{gid:a},success:function(i){var e=JSON.parse(i),n=e.smallpic.split(","),a=n.map(function(i){return'<li>\n                            <img src="'+i+'">\n                        </li>'}).join("");function r(i){var e=parseInt($(".lh").css("left"));e+=i,$("#spec-backward").removeClass("disabled"),$("#spec-forward").removeClass("disabled"),e<=$("#spec-list").innerWidth()-$(".lh").innerWidth()?(e=$("#spec-list").innerWidth()-$(".lh").innerWidth(),$("#spec-backward").addClass("disabled")):0<e&&(e=0,$("#spec-forward").addClass("disabled")),$(".lh").animate({left:e},200)}$("#litu").html(a),$(".preview .main-img img").prop("src",n[0]),$(".zoomdiv").find("img").prop("src",n[0]),$(".itemInfo-wrap .sku-name").html(e.title),$(".itemInfo-wrap .news").html(e.nameother),$(".itemInfo-wrap .summary-price-wrap .summary-price .p-price .price").html(e.price),$("#buy-num").attr("data-kucun",""+e.kucun),$("#spec-n1").mousemove(function(i){$(".preview .jqZoomPup").show(),$(".preview .zoomdiv").show();var e=$(".preview .main-img img").offset(),n=i.pageX-e.left-$(".jqZoomPup").innerWidth()/2,a=i.pageY-e.top-$(".jqZoomPup").innerHeight()/2;n<=0?n=0:n>$(".preview .main-img img").innerWidth()-$(".preview .jqZoomPup").innerWidth()&&(n=$(".preview .main-img img").innerWidth()-$(".preview .jqZoomPup").innerWidth()),a<=0?a=0:a>$(".preview .main-img img").innerHeight()-$(".preview .jqZoomPup").innerHeight()&&(a=$(".preview .main-img img").innerHeight()-$(".preview .jqZoomPup").innerHeight()),$(".preview .jqZoomPup").css("left",n),$(".preview .jqZoomPup").css("top",a);var r=($(".preview .bigimg").innerWidth()-$(".preview .zoomdiv").innerWidth())/($(".preview .main-img img").innerWidth()-$(".preview .jqZoomPup").innerHeight());$(".preview .bigimg").css("left",r*-n),$(".preview .bigimg").css("top",r*-a)}),$("#spec-n1").mouseout(function(){$(".preview .jqZoomPup").hide(),$(".preview .zoomdiv").hide()}),$("#litu li img").mouseenter(function(){var i=$(this).prop("src");$(".preview .main-img img").prop("src",i),$(".zoomdiv").find("img").prop("src",i)});var s=$(".preview .spec-items ul li").length*$(".preview .spec-items ul li").eq(0).outerWidth(!0);$(".lh").css("width",s+"px");var o=$(".preview .spec-items ul li").eq(0).outerWidth(!0);function t(i){var e=$("#buy-num").data("kucun")-0;return $(".choose-btns .choose-amount a").removeClass("disabled"),i<=1?(i=1,$(".btn-reduce").addClass("disabled")):e<=i&&(i=e,$(".btn-add").addClass("disabled")),i}$("#spec-forward").click(function(){r(o)}),$("#spec-backward").click(function(){r(-o)}),$(".btn-add").click(function(){var i=$("#buy-num").val();i=t(++i),$("#buy-num").val(i)}),$(".btn-reduce").click(function(){var i=$("#buy-num").val();i=t(--i),$("#buy-num").val(i)}),$("#buy-num").keyup(function(){var i=$("#buy-num").val();i=t(i),$("#buy-num").val(i)})}});var r=void 0,s=getCookie("username");console.log(a,r,s),$("#InitCartUrl").click(function(){new Promise(function(e){$.ajax({type:"post",url:"../api/getbuycartadd.php",data:{gid:a,username:s},success:function(i){e(i)}})}).then(function(i){var e=JSON.parse(i);r=0<e.length?e[0].gnum-0:0;var n=$("#buy-num").val()-0;console.log(e,r,n),s?$.ajax({type:"post",url:"../api/addshopcart.php",data:{gid:a,username:s,gnum:r+n},success:function(i){console.log(i),"update"!=i&&"insert"!=i||(location.href="cart.html?"+a)}}):(alert("请登录你的用户"),location.href="login.html")})})}();